<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <link rel="stylesheet" href="style.css"/>

        <style>
          table {
            border-collapse: collapse;
            width: 100%;
          }
      
          th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
          }
        </style>
      </head>
      <body>
      
        <h3>Tabela de Nomes</h3>
        <table id="nameTable">
          <tr>
            <th>Nome</th>
            <th>Assinalar OK</th>
            <th>Remover</th>
          </tr>
          <tr>
            <td><link>João</link></td>
            <td><input type="checkbox" class="nameCheckbox"></td>
            <td><button onclick="removerNome(this)">Remover</button></td>
          </tr>
          <tr>
            <td><link>Maria</link></td>
            <td><input type="checkbox" class="nameCheckbox"></td>
            <td><button onclick="removerNome(this)">Remover</button></td>
          </tr>
          <tr>
            <td><link>Pedro</link></td>
            <td><input type="checkbox" class="nameCheckbox"></td>
            <td><button onclick="removerNome(this)">Remover</button</td>
          </tr>
        </table>
      
        <button onclick="adicionarNome()">Adicionar Nome</button>
        <button onclick="limparSelecionados()">Limpar Selecionados</button>
        <button onclick="gerarImagem()">Gerar Imagem</button>
        <button onclick="realcarLinha(prompt('Digite o nome a destacar:'))">Férias</button>
        <button onclick="restaurarRealce()">Voltar das Férias</button>
      
        <script>
          function adicionarNome() {
            var nome = prompt("Digite o nome a adicionar:");
            if (nome != null) {
              var table = document.getElementById("nameTable");
              var row = table.insertRow(-1);
              var cell1 = row.insertCell(0);
              var cell2 = row.insertCell(1);
              var cell3 = row.insertCell(2);
              cell1.innerHTML = nome;
              cell2.innerHTML = '<input type="checkbox" class="nameCheckbox">';
              cell3.innerHTML = '<button onclick="removerNome(this)">Remover</button>';
            }
          }
      
          function removerNome(row) {
            var rowIndex = row.parentNode.parentNode.rowIndex;
            document.getElementById("nameTable").deleteRow(rowIndex);
          }
      
          function limparSelecionados() {
            const checkboxes = document.querySelectorAll('.nameCheckbox');
            checkboxes.forEach(checkbox => {
              checkbox.checked = false;
            });
          }
      
          function realcarLinha(nome) {
            var table = document.getElementById("nameTable");
            for (var i = 1; i < table.rows.length; i++) {
              if (table.rows[i].cells[0].innerText === nome) {
                table.rows[i].style.backgroundColor = "#FFA07A";
              }
            }
          }
      
          function restaurarRealce() {
            var table = document.getElementById("nameTable");
            for (var i = 1; i < table.rows.length; i++) {
              table.rows[i].style.backgroundColor = "";
            }
          }
      
          function gerarImagem() {
            html2canvas(document.getElementById('nameTable')).then(function(canvas) {
              var img = canvas.toDataURL('image/png');
              var link = document.createElement('a');
              link.href = img;
              link.download = 'tabela_nomes.png';
              link.click();
            });
          }
        </script>
        <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
      
      </body>
      </html>